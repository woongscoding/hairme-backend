# ==================== HairMe Backend Environment Variables ====================
# Copy this file to .env and fill in your actual values
# DO NOT commit .env to version control
# ================================================================================

# ==================== Application Settings ====================
LOG_LEVEL=INFO
MODEL_NAME=gemini-1.5-flash-latest

# ==================== API Keys ====================
# Get your Gemini API key from: https://makersuite.google.com/app/apikey
GEMINI_API_KEY=your_gemini_api_key_here

# Admin API Key for protected admin endpoints
# Generate a secure random string: openssl rand -hex 32
ADMIN_API_KEY=your_admin_api_key_here

# ==================== Database Configuration ====================
# Choose between MySQL (RDS) or DynamoDB

# Set to 'true' to use DynamoDB, 'false' to use MySQL
USE_DYNAMODB=false

# ---------- MySQL/RDS Configuration (when USE_DYNAMODB=false) ----------
# Database connection URL
# Format: mysql+pymysql://username:password@host:port/database
DATABASE_URL=mysql+pymysql://admin@hairme-data-v2.xxxx.ap-northeast-2.rds.amazonaws.com:3306/hairme

# Database password (injected into DATABASE_URL if using admin@ pattern)
DB_PASSWORD=your_db_password_here

# ---------- DynamoDB Configuration (when USE_DYNAMODB=true) ----------
# AWS region for DynamoDB
AWS_REGION=ap-northeast-2

# DynamoDB table name
DYNAMODB_TABLE_NAME=hairme-analysis

# AWS credentials (optional if using AWS CLI configuration)
# Alternative: Use 'aws configure' or EC2 instance role
# AWS_ACCESS_KEY_ID=your_access_key_here
# AWS_SECRET_ACCESS_KEY=your_secret_access_key_here

# ==================== Redis Cache (Optional) ====================
# Redis connection URL for caching
# Format: redis://host:port/db
REDIS_URL=redis://hairme-redis.xxxx.cache.amazonaws.com:6379/0

# Redis password (if required)
# REDIS_PASSWORD=your_redis_password_here

# ==================== AWS Services (for Lambda deployment) ====================
# Lambda function name (when deploying to AWS Lambda)
# AWS_LAMBDA_FUNCTION_NAME=hairme-analyze-function

# S3 bucket for image caching (optional)
# S3_BUCKET_NAME=hairme-image-cache

# ==================== Development Settings ====================
# Set to 'development' or 'production'
ENVIRONMENT=development

# Enable debug mode (detailed error messages)
DEBUG=false

# ==================== Security Settings ====================
# Allow CORS from these origins (comma-separated)
ALLOWED_ORIGINS=http://localhost:3000,https://hairme.app

# Rate limiting is automatically enabled (10 requests/minute for analyze endpoints)
# File upload size limit: 10MB (configured in code)

# ==================== Testing Configuration ====================
# Use these values for running tests
# TEST_DATABASE_URL=sqlite:///./test.db
# TEST_DYNAMODB_TABLE_NAME=hairme-analysis-test
# TEST_AWS_REGION=ap-northeast-2

# ==================== Migration Settings ====================
# RDS to DynamoDB migration
# MIGRATION_BATCH_SIZE=25
# MIGRATION_DRY_RUN=true

# ==================== Monitoring & Logging ====================
# CloudWatch log group (for AWS deployment)
# CLOUDWATCH_LOG_GROUP=/aws/lambda/hairme-analyze

# Sentry DSN for error tracking (optional)
# SENTRY_DSN=https://xxxxx@sentry.io/xxxxx

# ==================== Performance Tuning ====================
# FastAPI workers (for uvicorn)
# WORKERS=4

# Request timeout (seconds)
# REQUEST_TIMEOUT=30

# Max file upload size (MB)
# MAX_UPLOAD_SIZE_MB=10

# ==================== Feature Flags ====================
# Enable/disable MediaPipe analysis
# ENABLE_MEDIAPIPE=true

# Enable/disable ML model predictions
# ENABLE_ML_PREDICTIONS=true

# Enable/disable Redis caching
# ENABLE_CACHE=true

# ==================== Example Production Configuration ====================
# For reference only - adjust based on your deployment

# --- MySQL (Current Setup) ---
# USE_DYNAMODB=false
# DATABASE_URL=mysql+pymysql://admin@hairme-data-v2.xxxxx.rds.amazonaws.com:3306/hairme
# DB_PASSWORD=SecurePassword123!
# REDIS_URL=redis://hairme-redis.xxxxx.cache.amazonaws.com:6379/0

# --- DynamoDB (Target Setup) ---
# USE_DYNAMODB=true
# AWS_REGION=ap-northeast-2
# DYNAMODB_TABLE_NAME=hairme-analysis
# (AWS credentials from EC2 instance role or Lambda execution role)

# ==================== Notes ====================
# 1. MySQL â†’ DynamoDB Migration Checklist:
#    a. Create DynamoDB table: ./scripts/create_dynamodb_table.sh
#    b. Test connection: python scripts/test_dynamodb_connection.py
#    c. Run integration tests: pytest tests/test_dynamodb_integration.py -v
#    d. Set USE_DYNAMODB=true
#    e. Restart application
#
# 2. AWS Credentials Priority:
#    a. Environment variables (AWS_ACCESS_KEY_ID, AWS_SECRET_ACCESS_KEY)
#    b. AWS credentials file (~/.aws/credentials)
#    c. EC2 instance role / Lambda execution role
#
# 3. Cost Optimization:
#    - DynamoDB: Free tier (25 GB + 25 WCU/RCU)
#    - MySQL RDS: ~$12/month (db.t4g.micro)
#    - Redis ElastiCache: ~$12/month (cache.t4g.micro)
#
# 4. Local Development:
#    - Use SQLite for testing: DATABASE_URL=sqlite:///./local.db
#    - Or use DynamoDB Local: docker run -p 8000:8000 amazon/dynamodb-local
#
# 5. Security Best Practices:
#    - Never commit .env to git (add to .gitignore)
#    - Rotate credentials regularly
#    - Use AWS Secrets Manager for production
#    - Enable SSL for database connections
#
# ================================================================================
