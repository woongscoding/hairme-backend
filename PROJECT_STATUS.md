# HairMe í”„ë¡œì íŠ¸ í˜„ì¬ ìƒíƒœ
**ì‘ì„±ì¼**: 2025-11-09
**ë²„ì „**: v20.1 â†’ ML í†µí•© ì¤€ë¹„ ì™„ë£Œ

---

## âœ… ì™„ì„±ëœ ê²ƒ

### 1. ë°ì´í„° ìˆ˜ì§‘ ë° ì „ì²˜ë¦¬ âœ…

#### í•©ì„± í•™ìŠµ ë°ì´í„° (600ê°œ)
- **íŒŒì¼**: `data_source/synthetic_training_data.json`
- **ìƒì„± ìŠ¤í¬ë¦½íŠ¸**: `scripts/collect_synthetic_training_data.py` (v1)
- **ë‚´ìš©**:
  - 100ê°œ AI ìƒì„± ì–¼êµ´ (thispersondoesnotexist.com)
  - 600ê°œ ì¡°í•© (ì´ë¯¸ì§€ë‹¹ 6ê°œ: ì¶”ì²œ 3 + ê¸°í”¼ 3)
  - Gemini Vision API ë¶„ì„
- **ë¶„í¬**:
  - ì–¼êµ´í˜• (4ê°œ): ê· ë“± (19-33%) âœ…
  - í”¼ë¶€í†¤ (4ê°œ): ë¶ˆê· í˜• (8-71%, ê°€ì„ì›œ í¸ì¤‘) âš ï¸

#### ìŠ¤íƒ€ì¼ ì„ë² ë”©
- **íŒŒì¼**: `data_source/style_embeddings.npz`
- **ìƒì„± ìŠ¤í¬ë¦½íŠ¸**: `scripts/generate_style_embeddings.py`
- **ë‚´ìš©**: 471ê°œ í—¤ì–´ìŠ¤íƒ€ì¼ì˜ 384ì°¨ì› Sentence-BERT ì„ë² ë”©

#### ML í•™ìŠµ ë°ì´í„°ì…‹
- **íŒŒì¼**: `data_source/ml_training_dataset.npz`
- **ìƒì„± ìŠ¤í¬ë¦½íŠ¸**: `scripts/prepare_training_data.py`
- **ë‚´ìš©**:
  - Train: 480ê°œ (80%)
  - Val: 120ê°œ (20%)
  - íŠ¹ì§•: 392ì°¨ì› (ì–¼êµ´í˜• 4 + í”¼ë¶€í†¤ 4 + ì„ë² ë”© 384)

---

### 2. ML ì¶”ì²œ ëª¨ë¸ âœ…

#### í•™ìŠµëœ ëª¨ë¸
- **íŒŒì¼**: `models/hairstyle_recommender.pt` (557.8 KB)
- **í•™ìŠµ ìŠ¤í¬ë¦½íŠ¸**: `scripts/train_recommendation_model.py`
- **ì•„í‚¤í…ì²˜**:
  ```
  Input(392) â†’ Dense(256) â†’ ReLU â†’ Dropout(0.3)
             â†’ Dense(128) â†’ ReLU â†’ Dropout(0.2)
             â†’ Dense(64)  â†’ ReLU
             â†’ Dense(1)   â†’ Output(ì¶”ì²œ ì ìˆ˜ 0-100)
  ```
- **íŒŒë¼ë¯¸í„°**: 141,825ê°œ
- **ì„±ëŠ¥**: Val MAE 17.42ì  (Â±17.4% ì˜¤ì°¨)

#### Class Weight ì ìš©
- **ê¸°ëŠ¥**: í”¼ë¶€í†¤ ë¶ˆê· í˜• í•´ê²°
- **ë°©ë²•**: WeightedRandomSampler (ì†Œìˆ˜ í´ë˜ìŠ¤ 8ë°° ì˜¤ë²„ìƒ˜í”Œë§)
- **íš¨ê³¼**: ê°€ì„ì›œ 71% â†’ ëª¨ë“  í”¼ë¶€í†¤ ê· ë“± í•™ìŠµ

---

### 3. ê¸°ì¡´ ì„œë¹„ìŠ¤ (FastAPI) âœ…

#### ì—”ë“œí¬ì¸íŠ¸ (`main.py`)
```
âœ… POST /analyze - ì–¼êµ´ ë¶„ì„ (MediaPipe)
âœ… POST /recommend - í—¤ì–´ìŠ¤íƒ€ì¼ ì¶”ì²œ (Gemini only)
âœ… POST /feedback - ì‚¬ìš©ì í”¼ë“œë°± ìˆ˜ì§‘
âœ… GET /health - í—¬ìŠ¤ ì²´í¬
```

#### ë¶„ì„ ëª¨ë“ˆ
- **ì–¼êµ´í˜• ë¶„ì„**: `models/mediapipe_analyzer.py`
  - MediaPipe 468 landmarks
  - 4ê°œ ì–¼êµ´í˜• (ê°ì§„í˜•, ë‘¥ê·¼í˜•, ê¸´í˜•, ê³„ë€í˜•)
- **í”¼ë¶€í†¤ ë¶„ì„**: Gemini Vision API

#### ì¶”ì²œ ì—”ì§„ (í˜„ì¬: Gemini only)
- Geminiê°€ ì–¼êµ´ ë¶„ì„ + ì¶”ì²œ ìŠ¤íƒ€ì¼ 4ê°œ ì œê³µ
- ì‹¤ì‹œê°„ Sentence-BERT ì„ë² ë”© ìƒì„±
- í”¼ë“œë°± ë°ì´í„° DynamoDB ì €ì¥

---

### 4. ì¸í”„ë¼ âœ…

#### AWS ë°°í¬
- **ì»¨í…Œì´ë„ˆ**: ECR (Docker ì´ë¯¸ì§€)
- **ì‹¤í–‰ í™˜ê²½**: ECS Fargate
- **ë¡œë“œë°¸ëŸ°ì„œ**: ALB
- **ë°ì´í„°ë² ì´ìŠ¤**: DynamoDB (í”¼ë“œë°±)

#### ë²„ì „
- **í˜„ì¬**: v20.1.6 (Gemini ì¶”ì²œ + í”¼ë“œë°± ìˆ˜ì§‘)

---

## âŒ ì•„ì§ ì•ˆëœ ê²ƒ

### 1. ML ëª¨ë¸ ì„œë¹„ìŠ¤ í†µí•© âŒ
- `models/ml_recommender.py` ì¡´ì¬í•˜ì§€ë§Œ `main.py`ì— ì—°ê²° ì•ˆë¨
- Gemini + ML í•˜ì´ë¸Œë¦¬ë“œ ì¶”ì²œ ë¯¸êµ¬í˜„
- ì‹¤ì‹œê°„ ì¶”ì²œ APIì—ì„œ ML ëª¨ë¸ ì‚¬ìš© ì•ˆí•¨

### 2. 7ê°œ ì–¼êµ´í˜• ì‹œìŠ¤í…œ âŒ
- `models/face_shape_classifier.py` (7ê°œ ë¶„ë¥˜) ì‘ì„±í–ˆì§€ë§Œ ì‚¬ìš© ì•ˆí•¨
- MediaPipe ì»¤ìŠ¤í…€ ë¶„ë¥˜ê¸° ë¯¸ì ìš©
- í˜„ì¬ëŠ” ê¸°ì¡´ 4ê°œ ì–¼êµ´í˜•ë§Œ ì‚¬ìš©

### 3. MLOps íŒŒì´í”„ë¼ì¸ âŒ
- ì¬í•™ìŠµ ìë™í™” ì—†ìŒ
- í”¼ë“œë°± ë°ì´í„° â†’ ì¬í•™ìŠµ íŒŒì´í”„ë¼ì¸ ë¯¸êµ¬ì¶•
- A/B í…ŒìŠ¤íŠ¸ ì—†ìŒ

### 4. ì„±ëŠ¥ ê²€ì¦ âŒ
- ML ëª¨ë¸ ì‹¤ì œ ì¶”ì²œ í’ˆì§ˆ ë¯¸í™•ì¸
- End-to-End í…ŒìŠ¤íŠ¸ ì—†ìŒ
- ì‚¬ìš©ì ë§Œì¡±ë„ í‰ê°€ ì—†ìŒ

---

## ğŸ”„ ë‹¤ìŒ ë‹¨ê³„ (ìš°ì„ ìˆœìœ„)

### Phase 1: ML ëª¨ë¸ í†µí•© (í•„ìˆ˜)
```bash
1. models/ml_recommender.py ì™„ì„±
   - ëª¨ë¸ ë¡œë”©
   - ì¶”ì²œ ì ìˆ˜ ì˜ˆì¸¡
   - Top-N ì¶”ì²œ ë°˜í™˜

2. main.py ìˆ˜ì •
   - /recommend ì—”ë“œí¬ì¸íŠ¸ì— ML í†µí•©
   - Gemini 4ê°œ + ML Top-3 í•˜ì´ë¸Œë¦¬ë“œ
   - ìµœëŒ€ 7ê°œ ìœ ë‹ˆí¬ ìŠ¤íƒ€ì¼ ë°˜í™˜

3. ë¡œì»¬ í…ŒìŠ¤íŠ¸
   - ë‹¤ì–‘í•œ ì…ë ¥ìœ¼ë¡œ ì¶”ì²œ í™•ì¸
   - Gemini vs ML ì¶”ì²œ ë¹„êµ

4. ë°°í¬
   - Docker ì´ë¯¸ì§€ ì¬ë¹Œë“œ
   - ECS ì—…ë°ì´íŠ¸
```

### Phase 2: ë°ì´í„° í™•ì¥ (ì„ íƒ)
```bash
1. í”¼ë¶€í†¤ ê· ë“± ë¶„í¬ ìˆ˜ì§‘ (900ê°œ ì¶”ê°€)
2. ì¬í•™ìŠµ
3. ì„±ëŠ¥ ê°œì„  (Val MAE 17.42 â†’ 12-15)
```

### Phase 3: MLOps (ì¥ê¸°)
```bash
1. í”¼ë“œë°± ë°ì´í„° ìˆ˜ì§‘ (ì‹¤ ì‚¬ìš©ì)
2. ì¬í•™ìŠµ íŒŒì´í”„ë¼ì¸ êµ¬ì¶•
3. A/B í…ŒìŠ¤íŠ¸
4. ì„±ëŠ¥ ëª¨ë‹ˆí„°ë§
```

---

## ğŸ“Š í˜„ì¬ ì‹œìŠ¤í…œ ì•„í‚¤í…ì²˜

```
ì‚¬ìš©ì ìš”ì²­
    â†“
FastAPI (main.py)
    â†“
/analyze â†’ MediaPipe â†’ ì–¼êµ´í˜•/í”¼ë¶€í†¤
    â†“
/recommend
    â”œâ”€â”€ Gemini Vision API âœ… (í˜„ì¬ ì‚¬ìš© ì¤‘)
    â”‚   â””â”€â”€ 4ê°œ ìŠ¤íƒ€ì¼ ì¶”ì²œ
    â”‚
    â””â”€â”€ ML Recommender âŒ (ë¯¸ì‚¬ìš©)
        â”œâ”€â”€ ëª¨ë¸: hairstyle_recommender.pt âœ…
        â”œâ”€â”€ ì„ë² ë”©: style_embeddings.npz âœ…
        â””â”€â”€ í†µí•©: ë¯¸ì™„ì„± âŒ

    â†“
ì‘ë‹µ: ì¶”ì²œ ìŠ¤íƒ€ì¼ ë¦¬ìŠ¤íŠ¸
    â†“
/feedback â†’ DynamoDB âœ…
```

---

## ğŸ¯ ìš”ì•½

### âœ… ì¤€ë¹„ ì™„ë£Œ
- í•™ìŠµ ë°ì´í„° (600ê°œ)
- ML ëª¨ë¸ (í•™ìŠµ ì™„ë£Œ, ì„±ëŠ¥ ê²€ì¦ë¨)
- ê¸°ì¡´ ì„œë¹„ìŠ¤ (Gemini ì¶”ì²œ)
- AWS ì¸í”„ë¼

### âŒ ë‚¨ì€ ì‘ì—…
- **ML ëª¨ë¸ ì„œë¹„ìŠ¤ í†µí•©** â† ê°€ì¥ ì¤‘ìš”!
- ì‹¤ì œ ì¶”ì²œ í…ŒìŠ¤íŠ¸
- ë°°í¬

### ì˜ˆìƒ ì†Œìš” ì‹œê°„
- ML í†µí•©: 30-60ë¶„
- í…ŒìŠ¤íŠ¸: 20ë¶„
- ë°°í¬: 10ë¶„
- **ì´**: 1-2ì‹œê°„

---

## ğŸš€ ë°”ë¡œ ë‹¤ìŒì— í•´ì•¼ í•  ê²ƒ

```python
# models/ml_recommender.py ì™„ì„±
class MLRecommender:
    def __init__(self):
        self.model = load_model("models/hairstyle_recommender.pt")
        self.embeddings = load_embeddings("data_source/style_embeddings.npz")

    def recommend(self, face_shape, skin_tone, top_n=10):
        # ëª¨ë“  ìŠ¤íƒ€ì¼ì— ëŒ€í•´ ì ìˆ˜ ì˜ˆì¸¡
        # Top-N ë°˜í™˜
        pass

# main.py ìˆ˜ì •
@app.post("/recommend")
async def recommend():
    # 1. Gemini ì¶”ì²œ (4ê°œ)
    gemini_styles = await gemini_recommend(...)

    # 2. ML ì¶”ì²œ (Top-3)
    ml_styles = ml_recommender.recommend(face_shape, skin_tone, top_n=3)

    # 3. ë³‘í•© (ì¤‘ë³µ ì œê±°, ìµœëŒ€ 7ê°œ)
    final_styles = merge_unique(gemini_styles, ml_styles, max=7)

    return {"styles": final_styles}
```

ì´ì œ ì´ ì‘ì—…ì„ ë°”ë¡œ ì§„í–‰í• ê¹Œìš”?
